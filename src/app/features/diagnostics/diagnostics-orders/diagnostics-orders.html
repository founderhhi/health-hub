<section class="diagnostics-orders">
  <div class="orders-container">
    <!-- Page Header -->
    <header class="page-header">
      <h1 class="page-title">Diagnostics Orders</h1>
      <p class="page-subtitle">Manage incoming diagnostic orders</p>
    </header>

    <!-- Collapsible Filter Section -->
    <div class="filters-section">
      <button class="filter-toggle" (click)="toggleFilters()" [attr.aria-expanded]="filtersExpanded">
        <svg class="filter-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
        </svg>
        <span>Filters</span>
        <svg class="toggle-icon" [class.expanded]="filtersExpanded" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </button>
      
      <div class="filters-content" [class.expanded]="filtersExpanded">
        <p class="filters-helper" *ngIf="!filtersAvailable">
          Filters are coming soon. Live order updates are still active.
        </p>
        <div class="filters-grid">
          <input type="text" class="filter-input" placeholder="Order ID" [disabled]="!filtersAvailable" />
          <input type="text" class="filter-input" placeholder="Patient name" [disabled]="!filtersAvailable" />
          <select class="filter-select" [disabled]="!filtersAvailable">
            <option value="">All Status</option>
            <option value="new">New</option>
            <option value="in_progress">In Progress</option>
            <option value="completed">Completed</option>
          </select>
          <select class="filter-select" [disabled]="!filtersAvailable">
            <option value="">All Priorities</option>
            <option value="routine">Routine</option>
            <option value="urgent">Urgent</option>
            <option value="emergency">Emergency</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Orders List -->
    <div class="orders-list">
      <div class="order-card" *ngFor="let order of orders">
        <span class="badge badge-new" *ngIf="order.status === 'ordered'">NEW</span>
        <div class="order-card-header">
          <span class="order-id">DX-{{ order.id | slice:0:8 }}</span>
          <span
            class="badge"
            [ngClass]="{
              'badge-routine': order.status === 'ordered',
              'badge-urgent': order.status === 'in_progress',
              'badge-emergency': order.status === 'completed'
            }"
          >
            {{ order.status | titlecase }}
          </span>
        </div>
        <div class="order-patient">
          <span class="patient-label">Patient:</span>
          <span class="patient-name">{{ order.patient_name || order.patient_phone || 'Patient' }}</span>
        </div>
        <div class="order-tests">
          <span class="test-item" *ngFor="let test of order.tests">{{ test }}</span>
        </div>
        <div class="order-footer">
          <span class="order-date">Received: {{ order.created_at | date:'short' }}</span>
          <button class="btn btn-primary" (click)="viewOrder(order.id)">View Order</button>
        </div>
      </div>
    </div>
    <div class="empty-state" *ngIf="orders.length === 0">
      <p>No diagnostic orders yet.</p>
    </div>

    <!-- Pull to refresh indicator -->
    <div class="pull-refresh">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="23 4 23 10 17 10"></polyline>
        <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
      </svg>
      <span>Pull to refresh orders</span>
    </div>
  </div>

  <!-- Mobile Bottom Navigation -->
  <nav class="bottom-nav">
    <a class="nav-item active" routerLink="/diagnostics">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="3" y="3" width="7" height="7"></rect>
        <rect x="14" y="3" width="7" height="7"></rect>
        <rect x="14" y="14" width="7" height="7"></rect>
        <rect x="3" y="14" width="7" height="7"></rect>
      </svg>
      <span class="nav-label">Orders</span>
    </a>
    <a class="nav-item" [routerLink]="['/diagnostics/upload', orders[0]?.id]">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="17 8 12 3 7 8"></polyline>
        <line x1="12" y1="3" x2="12" y2="15"></line>
      </svg>
      <span class="nav-label">Upload</span>
    </a>
    <a class="nav-item" routerLink="/diagnostics">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
        <polyline points="14 2 14 8 20 8"></polyline>
        <line x1="16" y1="13" x2="8" y2="13"></line>
        <line x1="16" y1="17" x2="8" y2="17"></line>
        <polyline points="10 9 9 9 8 9"></polyline>
      </svg>
      <span class="nav-label">Reports</span>
    </a>
  </nav>
</section>
